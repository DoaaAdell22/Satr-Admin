import{u as q,a as f,b as z,c as A,r as h,j as e,F as s,B as c,n as F,i as y}from"./index-CbNkVbyA.js";import{u as C,F as l}from"./index-nfIlcgR5.js";import{config as a}from"./page-Dja84iEc.js";import{u as D,g as L}from"./cols-BOaOIlnr.js";import{S as U}from"./index-MxrXartz.js";import{P as Q}from"./index-UsCyEadM.js";import{R,C as T}from"./row-CIqPCr0D.js";import{I as u}from"./index-VC5Afaew.js";import{S}from"./index-Bs3OOa-i.js";import{U as V,a as X}from"./UploadOutlined-BProoqtw.js";import{Q as K}from"./QuestionCircleOutlined-CFn8tONO.js";import{D as M}from"./DeleteOutlined-BtHf3aBj.js";import{F as Y}from"./FileDoneOutlined-CyyXZx_B.js";import"./index-BN2C5pGS.js";import"./index-CC6DCI0n.js";import"./utils-km2FGkQ4.js";import"./index-De1vea9t.js";import"./index-CbNQXSC4.js";const{Option:G}=S;function fe(){`${q().pathname.split("/").filter(r=>r).slice(0,2).join("/")}`;const I=f(({profile:r})=>r.data),{idToken:m}=f(r=>r.Auth),{locale:p}=f(({LanguageSwitcher:r})=>r.language),{id:t}=z(),[b]=C(),x=A(),[O,g]=h.useState(!1),[P,j]=h.useState(!1),v=r=>{var d;const i=new FormData;t&&a.edit.method==="post"&&i.append("_method","put");for(const n in r){const o=r[n];n==="material_image"?Array.isArray(o)&&i.append(n,(d=o[0])==null?void 0:d.originFileObj):i.append(n,o)}g(!0),F.promise(y[t?a.edit.method:a.add.method](t?`${a.edit.url}/${t}`:a.add.url,i,{headers:{"X-Portal":"dashboard",Authorization:`Bearer ${m}`}}),{loading:e.jsx("div",{className:"min-w-[200px]",children:p==="ar"?"جاري المعالجة ":"Pending"}),success:n=>{const{message:o}=n.data;return x(-1),g(!1),o||"Backend Error Occured"},error:n=>{var o,_;return g(!1),((_=(o=n.response)==null?void 0:o.data)==null?void 0:_.message)||"Backend Error Occured"}})},E=()=>{j(!0),F.promise(y[a.delete.method](`${a.delete.url}/${t}`,{headers:{"X-Portal":"dashboard",Authorization:`Bearer ${m}`}}),{loading:p==="ar"?"جاري المعالجة ":"Pending",success:r=>{const{message:i}=r.data;return x(-1),j(!1),i||"Backend Error Occured"},error:r=>{var i,d;return j(!1),((d=(i=r.response)==null?void 0:i.data)==null?void 0:d.message)||"Backend Error Occured"}})},{isFetching:$,isPending:w,isError:W,data:B,isSuccess:N}=D({queryKey:[t,m],queryFn:()=>y[a.findOne.method](`${a.findOne.url}/${t}`,{headers:{"X-Portal":"dashboard",Authorization:`Bearer ${m}`}}),enabled:!!t});h.useEffect(()=>{var r;N&&b.setFieldsValue((r=B.data)==null?void 0:r.data)},[w]);const k=[{id:1,name_en:"Ceil",name_ar:"سقف"},{id:2,name_en:"Floor",name_ar:"ارضية"},{id:3,name_en:"wall",name_ar:"حائط"}];return e.jsx(e.Fragment,{children:e.jsxs(U,{spinning:$,children:[e.jsx("div",{className:"flex flex-row-reverse",children:t&&L(a.delete.url,a.delete.type,I)?e.jsx(Q,{title:e.jsx(s,{id:"delete.deleteItem"}),description:e.jsx(s,{id:"delete.areYouSure"}),onConfirm:()=>E(),icon:e.jsx(K,{style:{color:"red"}}),children:e.jsx(c,{loading:P,icon:e.jsx(M,{className:"mx-1"}),type:"primary",danger:!0,children:e.jsx(s,{id:"delete"})})}):""}),e.jsx(R,{children:e.jsx(T,{span:24,children:e.jsxs(l,{form:b,onFinish:v,layout:"vertical",className:"login-form",children:[e.jsx(l.Item,{label:e.jsx(s,{id:"name_en"}),name:"name_en",rules:[{required:!0,message:e.jsx(s,{id:"name_en"})}],children:e.jsx(u,{type:"text",size:"large"})}),e.jsx(l.Item,{label:e.jsx(s,{id:"name_ar"}),name:"name_ar",rules:[{required:!0,message:e.jsx(s,{id:"name_ar"})}],children:e.jsx(u,{type:"text",size:"large"})}),e.jsx(l.Item,{label:e.jsx(s,{id:"price"}),name:"price",rules:[{required:!0,message:e.jsx(s,{id:"price"})}],children:e.jsx(u,{type:"text",size:"large"})}),e.jsx(l.Item,{label:e.jsx(s,{id:"percentage"}),name:"percentage",rules:[{required:!0,message:e.jsx(s,{id:"percentage"})}],children:e.jsx(u,{type:"text",size:"large"})}),e.jsx(l.Item,{label:e.jsx(s,{id:"category"}),name:"category",rules:[{required:!0,message:e.jsx(s,{id:"category"})}],children:e.jsx(S,{size:"large",children:k.map(r=>e.jsx(G,{value:r.id,children:p==="ar"?r.name_ar:r.name_en},r.id))})}),e.jsx(l.Item,{label:e.jsx(s,{id:"photo"}),name:"material_image",valuePropName:"fileList",rules:[{required:!0,message:e.jsx(s,{id:"image"})}],getValueProps:function(r){return{fileList:typeof r=="string"?r?[{uid:"-1",name:"photo",status:"done",url:r}]:[]:r}},getValueFromEvent:r=>(console.log({e:r}),Array.isArray(r)?r:r&&r.fileList),children:e.jsx(V,{maxCount:1,name:"image",beforeUpload:r=>!1,listType:"picture-card",children:e.jsx(c,{type:"text",icon:e.jsx(X,{}),children:e.jsx(s,{id:"upload"})})})}),e.jsxs("div",{className:"flex gap-4 flex-wrap mt-8",children:[e.jsx(c,{className:"w-[90px]",icon:e.jsx(Y,{}),loading:O,type:"primary",htmlType:"submit",children:e.jsx("span",{children:t?e.jsx(s,{id:"global.save"}):e.jsx(s,{id:"global.save"})})}),e.jsx(c,{onClick:()=>x(-1),className:"w-[90px]",children:e.jsx(s,{id:"global.back"})})]})]})})})]})})}export{fe as default};
